---
title: Aid Information Platform
---

<%= partial "partials/projects-header", :locals => { :project => project, :active => "summary", :has_funded_projects => has_funded_projects} %>

<div class="row">

    <div class="twelve columns summary">
        <p class="project-description"><%= project['description'] %></p>
    </div>

</div>

<div class="row">

    <div class="six columns">

            <h3 class="info-notice">Funding - Unconditional</h3>
            <div id="funding-progress" style="height: 150px;" class="progress">
            </div>

       
            <h3 class="info-notice">Status - <%= activty_status(project['status']) %></h3>
            <div id="time-progress" style="height: 150px;" class="progress">
            </div>
    </div>

    <div class="six columns">
        <div id="countryMap" class="countryMap"></div>

        <input type="hidden" id="countryName" value="<%= country_name(project['recipient']) %>">
        <input type="hidden" id="countryCode" value="<%= project['recipient'] %>">
        <input type="hidden" id="projectType" value="<%= project['projectType'] %>">
       
        <script src="http://maps.googleapis.com/maps/api/js?sensor=false"></script>
        <script src="/javascripts/regionBounds.js" type="text/javascript"></script>
        <script src="/javascripts/leaflet/countryBounds.js" type="text/javascript"></script>
        <script src="/javascripts/countrymap.js" type="text/javascript"></script>

        <div id="countryMapDisclaimer" class="disclaimer grey">
            <p><strong>Disclaimer</strong>: Country borders do not necessarily reflect the UK Government's official position.</p>
        </div>
    </div>

</div>

<div class="row">
    <div class="six columns">
        <h3 class="info-notice">Sector groups</h3>
        <div id="sector-breakdown" style="float:left;" class="donut"></div>
        <div id="sector-legend" style="float:left;">
            <table>
                <% (project_sector_groups(project['iatiId']) || []).each do |sector| %>                
                    <tr class="legend-item">
                        <td>
                            <span class="legend-color"></span>
                            <span class="truncate" style="width: 155px;" title="<%=sector[:sector]%>"><%=sector[:sector]%></span>
                        </td>
                        <td><%=sector[:formatted]%></td>
                    </tr>
                <% end %>
            </table>

        </div>
    </div>
    <div class="six columns">
        <h3 class="info-notice">Project budget vs actual spend</h3>
        <div id="budget-plan-spend" style="height: 250px; width: 480px;" class="progress"></div>
        <div id="budget-plan-spend-legend">
            <table style="margin-left:auto; margin-right:auto;">              
                    <tr class="legend-item">
                        <td>
                            <div class="legend-rect" style="background-color:#D8DCBF;"></div>
                            <span class="truncate" style="width: 155px; margin-left:4px;" title="Budget">Budget</span>
                        </td>
                        <td><td>
                            <div class="legend-rect" style="background-color:#2B6367;"></div>
                            <span class="truncate" style="width: 155px; margin-left:4px" title="Spend">Spend</span>
                        </td></td>
                    </tr>
            </table>
        </div>
    </div>

    <script type="text/javascript" src="/javascripts/donut.js"></script>
    <script type="text/javascript" src="/javascripts/progress.js"></script>
    <script type="text/javascript" src="/javascripts/bar.js"></script>

    <script type="text/javascript">
        (function(){
            var sectors = <%= project_sector_groups(project['iatiId']).to_json %>;
            charts.donut("#sector-breakdown", sectors, function(d) { return d.budget; }, function(d){ return d.sector }, function(d){ return d.formatted });
            charts.donutLegend("#sector-legend", ".legend-color", 14, sectors, function(d){ return d.sector });

            var funding = [ {label: "", text: "", value: 0},
                            {label: "Budget spend to date", text: "<%= number_to_currency(project['totalProjectSpend'], :unit=>"£", :precision => 0) || 0.00 %>", value: <%= (project['totalProjectSpend'] || 0.00) %>},
                            {label: "Project budget", text: "<%= number_to_currency(project['totalBudget'], :unit=>"£", :precision => 0) || 0.00 %>", value: <%= (project['totalBudget'] || 0.00) %>}]
            charts.progressBar("#funding-progress", funding, function(d) { return d.value; }, function(d) { return d.label; }, function(d) { return d.text; });

            var time = [ {label: "Start",
                          text: "<%= format_date(choose_better_date(project['start-actual'], project['start-planned'])) %>",
                          value: <%= choose_better_date(project['start-actual'], project['start-planned']) %>},
                         {label: "Progress by time",
                          text: "",
                          value: new Date().getTime()},
                         {label: "End",
                          text: "<%= format_date(choose_better_date(project['end-actual'], project['end-planned'])) %>",
                          value: <%= choose_better_date(project['end-actual'],   project['end-planned']) %>}];
            charts.progressBar("#time-progress", time, function(d) { return d.value; }, function(d) { return d.label; }, function(d) { return d.text; });

            var budgets = <%= ([["Year" ,"Plan", "Spend"]]) + (project_budget_per_fy project['iatiId']) %>;
            charts.bar("#budget-plan-spend", budgets, ".2s", null, null, ["#D8DCBF", "#2B6367"]);
        })()
    </script>


</div>